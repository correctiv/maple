<mapple-docs class="mapple-docs">

  <div class="body-wrapper mapple-docs">
    <header class="mapple-header">
      <a href="/" class="mapple-header__logo" />
    </header>
    <main id="main" class="site-main" role="main">
      <div class="container">
        <div class="page-wrapper">
          <div class="text box">
            <section id="inner-content" />
          </div>
        </div>
      </div>
    </main>
  </div>

  <script>
    import * as riot from 'riot'
    import { STORE, CONTROL, EVENTS } from '~/events.js'
    import MappleExamples from './examples.riot'
    import MappleGenerateLinks from './generate-links.riot'
    import examples from './examples.js'

    const content = require('html-loader!markdown-loader!./docs.md')
    .replace(/{{ BASE_URL }}/g, STORE.baseUrl)
    .replace(/{{ EXAMPLE_GID }}/g, examples.nuts3.gid)

    const loadCss = url => {
      const link = document.createElement('link')
      link.href = url
      link.type = 'text/css'
      link.rel = 'stylesheet'
      document.getElementsByTagName('head')[0].appendChild(link)
    }

    export default {
      onMounted() {
        this.$('section#inner-content').innerHTML = content
        loadCss(this.props.cssUrl)
        riot.register('mapple-examples', MappleExamples)
        riot.register('mapple-generate-links', MappleGenerateLinks)
        riot.mount('mapple-examples')
        riot.mount('mapple-generate-links')
        CONTROL.trigger(EVENTS.loaded)
      }
    }
  </script>
</mapple-docs>
